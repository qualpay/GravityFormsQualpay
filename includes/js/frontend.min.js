function gravityformsqualpay(r,a,n){if(window.gf_cc_rules||(window.gf_cc_rules=gfp_qualpay_frontend_strings.credit_card_rules),a===parseInt(gfp_qualpay_frontend_strings.formId)&&(!gfp_qualpay_frontend_strings.hasPages||n===gfp_qualpay_frontend_strings.pageCount))if(gformQualpayIsPostback(a)&&gformQualpayHasError(a)){qpEmbeddedForm.unloadFrame();var _={action:"gaddon_qualpay_transient_key",gaddon_qualpay_transient_key:gfp_qualpay_frontend_strings.transient_key_nonce,form_id:a};jQuery.post(gfp_qualpay_frontend_strings.ajaxurl,_).done(function(r){!0===r.success&&(gfp_qualpay_frontend_strings.transientKey=r.data,gravityformsqualpay_load_frame())})}else gravityformsqualpay_load_frame()}function gravityformsqualpay_load_frame(){var r=jQuery("#capture_id").val(),a=jQuery("#achOnOff").val(),n=!1;"sale"!=r||1!=a&&""!=a||(n=!0),qpEmbeddedForm.loadFrame(gfp_qualpay_frontend_strings.merchant_id,{formId:gfp_qualpay_frontend_strings.form_element_id,mode:gfp_qualpay_frontend_strings.mode,transientKey:gfp_qualpay_frontend_strings.transientKey,tokenize:!0,onSuccess:gravityformsqualpay_success,onError:gravityformsqualpay_error,achConfig:{enabled:n}})}function gravityformsqualpay_success(r){var a=r.card_id,n=r.card_number,_=r.card_type,e=r.type_id,t=gfp_qualpay_frontend_strings.formId,o=jQuery("#gform_"+t),f=gfp_qualpay_frontend_strings.creditcard_field_id;o.find(gfp_qualpay_frontend_strings.responseField).val(a),o.find("#input_"+t+"_"+f+"_1").val(n),o.find("#input_"+t+"_"+f+"_4").val({AM:"Amex",DS:"Discover",PP:"PayPal",MC:"MasterCard",VS:"Visa",AP:"ACH"}[_]),o.find("#input_"+t+"_"+f+"_5").val(e),o.submit()}function gravityformsqualpay_error(r){var a=jQuery("#gform_"+gfp_qualpay_frontend_strings.formId);if(r.detail){var n="";for(let a in r.detail)n+=r.detail[a];a.find(gfp_qualpay_frontend_strings.errorField).val(n)}a.submit()}function gformQualpayIsPostback(r){var a=!1,n=jQuery("#gform_ajax_frame_"+r).contents().find("*").html();return void 0!==n&&(a=0<n.indexOf("GF_AJAX_POSTBACK")),a}function gformQualpayHasError(r){return jQuery("#gform_confirmation_wrapper_"+r).hasClass("gform_validation_error")||jQuery("#gform_ajax_frame_"+r).contents().find("#gform_wrapper_"+r).hasClass("gform_validation_error")}jQuery(document).on("gform_post_render",gravityformsqualpay);